{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/Users/gotre/projects/lupita/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/gotre/projects/lupita/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/Users/gotre/projects/lupita/pages/index.js\",\n    _s = $RefreshSig$();\n\nimport Head from 'next/head';\nimport { useState } from 'react';\nimport axios from 'axios';\nimport styles from '../styles/Home.module.css';\nimport { UiFileInputButton } from \"../components/UiFileInputButton\";\nvar config = {\n  headers: {\n    'content-type': 'multipart/form-data'\n  }\n};\n\nvar getVendor = function getVendor(data) {\n  var field = {}; // const field = data.data.summary.find(line => line.type == 'VENDOR_NAME') || {};\n\n  return field.value || 'No detectado';\n};\n\nvar getDate = function getDate(data) {\n  var field = {}; // const field = data.data.summary.find(line => line.type == 'INVOICE_RECEIPT_DATE') || {};\n\n  return field.value || 'No detectado';\n};\n\nvar getTotal = function getTotal(data) {\n  var field = {}; // const field = data.data.summary.find(line => line.type == 'TOTAL') || {};\n\n  return field.value || 'No detectado';\n};\n\nvar getInvoiceId = function getInvoiceId(data) {\n  var field = {}; // const field = data.data.summary.find(line => line.type == 'INVOICE_RECEIPT_ID') || {};\n\n  return field.value || 'No detectado';\n};\n\nexport default function Home() {\n  _s();\n\n  var _useState = useState(''),\n      src = _useState[0],\n      setSrc = _useState[1];\n\n  var _useState2 = useState(null),\n      data = _useState2[0],\n      setData = _useState2[1];\n\n  var _useState3 = useState(false),\n      loading = _useState3[0],\n      setLoading = _useState3[1];\n\n  var onChange = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(formData) {\n      var reader, response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setLoading(true);\n              setData(null);\n              setSrc('');\n              reader = new FileReader();\n\n              reader.onloadend = function () {\n                setSrc(reader.result);\n              };\n\n              reader.readAsDataURL(formData.get('image'));\n              _context.next = 8;\n              return axios.post('/api/upload-file', formData, config);\n\n            case 8:\n              response = _context.sent;\n              setLoading(false);\n              setData(response.data);\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function onChange(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.container,\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: [/*#__PURE__*/_jsxDEV(\"title\", {\n        children: \"Create Next App\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"link\", {\n        rel: \"icon\",\n        href: \"/favicon.ico\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: styles.main,\n      children: [/*#__PURE__*/_jsxDEV(UiFileInputButton, {\n        label: \"Subir imagen\",\n        uploadFileName: \"image\",\n        onChange: onChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 17\n      }, this), loading && /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Loading...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 29\n      }, this), !loading && src && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.image,\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: src,\n          alt: \"ticket\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 67\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 37\n      }, this), data && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Nombre fiscal: \", getVendor(data)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Fecha factura: \", getDate(data)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Total: \", getTotal(data)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Numero factura: \", getInvoiceId(data)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n          children: JSON.stringify(data, null, 2)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Home, \"rVpdlTAtCjyZJ8nxgDLBxgwWiBY=\");\n\n_c = Home;\n\nvar _c;\n\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"sources":["/Users/gotre/projects/lupita/pages/index.js"],"names":["Head","useState","axios","styles","UiFileInputButton","config","headers","getVendor","data","field","value","getDate","getTotal","getInvoiceId","Home","src","setSrc","setData","loading","setLoading","onChange","formData","reader","FileReader","onloadend","result","readAsDataURL","get","post","response","container","main","image","JSON","stringify"],"mappings":"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","sourcesContent":["import Head from 'next/head'\nimport { useState } from 'react';\nimport axios from 'axios';\n\nimport styles from '../styles/Home.module.css'\nimport {UiFileInputButton} from \"../components/UiFileInputButton\";\n\n\nconst config = {\n    headers: { 'content-type': 'multipart/form-data' },\n};\n\nconst getVendor = data => {\n    const field = {}\n    // const field = data.data.summary.find(line => line.type == 'VENDOR_NAME') || {};\n    return field.value || 'No detectado';\n}\n\nconst getDate = data => {\n    const field = {}\n    // const field = data.data.summary.find(line => line.type == 'INVOICE_RECEIPT_DATE') || {};\n    return field.value || 'No detectado';\n}\n\nconst getTotal = data => {\n    const field = {}\n    // const field = data.data.summary.find(line => line.type == 'TOTAL') || {};\n    return field.value || 'No detectado';\n}\n\nconst getInvoiceId = data => {\n    const field = {}\n    // const field = data.data.summary.find(line => line.type == 'INVOICE_RECEIPT_ID') || {};\n    return field.value || 'No detectado';\n}\n\nexport default function Home() {\n    const [src, setSrc] = useState('');\n    const [data, setData] = useState(null);\n    const [loading, setLoading] = useState(false);\n\n    const onChange = async (formData) => {\n        setLoading(true);\n        setData(null);\n        setSrc('');\n        const reader = new FileReader();\n        reader.onloadend = function() {\n            setSrc(reader.result);\n        }\n        reader.readAsDataURL(formData.get('image'));\n\n        const response = await axios.post('/api/upload-file', formData, config);\n        setLoading(false);\n        setData(response.data);\n    }\n\n    return (\n        <div className={styles.container}>\n            <Head>\n                <title>Create Next App</title>\n                <link rel=\"icon\" href=\"/favicon.ico\" />\n            </Head>\n\n            <main className={styles.main}>\n                <UiFileInputButton\n                      label=\"Subir imagen\"\n                      uploadFileName=\"image\"\n                      onChange={onChange}\n                />\n                {loading && <p>Loading...</p>}\n                {!loading && src && <div className={styles.image}><img src={src} alt=\"ticket\"/></div>}\n                {data &&\n                    (<>\n                        <p>Nombre fiscal: {getVendor(data)}</p>\n                        <p>Fecha factura: {getDate(data)}</p>\n                        <p>Total: {getTotal(data)}</p>\n                        <p>Numero factura: {getInvoiceId(data)}</p>\n                        <pre>{JSON.stringify(data, null, 2)}</pre>\n                    </>)\n                }\n            </main>\n\n        </div>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}